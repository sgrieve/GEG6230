<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>GEG6230 - Spatial Interpolation</title>

		<meta name="description" content="GEG6230 - Spatial Interpolation">
		<meta name="author" content="Stuart Grieve">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="../../reveal/css/reset.css">
		<link rel="stylesheet" href="../../reveal/css/reveal.css">
    <link rel="stylesheet" href="../../reveal/css/custom.css">
		<link rel="stylesheet" href="../../reveal/css/theme/night.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../../reveal/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../../reveal/css/print/pdf.css' : '../../reveal/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">


<section data-markdown>
<textarea data-template>

## Spatial Interpolation

GEG6230 - Stuart Grieve - Week 8

These slides:
https://swdg.io/GEG6230/week_8/lecture_a/index.html

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Lecture Overview

- What is interpolation?
- Thiessen polygons
- Inverse Distance Weighting (IDW)
- Splines
- Evaluating interpolation

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### What is interpolation?

- The creation of new data points **within the range** of existing data
- Often used to turn point measurements into a continuous surface
- Not to be confused with extrapolation, where we predict values **outside of the bounds** of our data

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### What is interpolation?

![Interpolation example](../../img/interpolation.svg) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### What is interpolation?

![extrapolation example](../../img/extrapolation.svg) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Applications of interpolation

![http://www.gitta.info/ContiSpatVar/en/html/Interpolatio_learningObject1.xhtml](../../img/swiss_rainfall_interp.jpg) <!-- .element width="70%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Applications of interpolation

<iframe data-src="https://www.youtube.com/embed/-QasXK524Sc?rel=0" data-autoplay class="stretch"></iframe>

</textarea>
</section>

<section>
  <h3>Sampling</h3>
  <div data-svg-fragment-big="../../img/interp_example.svg#[*|label=a]">
      <a class="fragment" title="[*|label=b]"></a>
      <a class="fragment" title="[*|label=c]"></a>
      <a class="fragment" title="[*|label=d]"></a>
      <a class="fragment" title="[*|label=e]"></a>
      <a class="fragment" title="[*|label=f]"></a>
      <a class="fragment" title="[*|label=g]"></a>
      <a class="fragment" title="[*|label=h]"></a>
      <a class="fragment" title="[*|label=i]"></a>
      <a class="fragment" title="[*|label=j]"></a>
      <a class="fragment" title="[*|label=l]"></a>
      <a class="fragment" title="[*|label=m]"></a>
      <a class="fragment" title="[*|label=o]"></a>
  </div>
</section>

<section data-markdown>
<textarea data-template>

### Sampling strategies

- Uniform
- Random
- What are the features we want to capture?
- Tradeoff between cost and accuracy

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Requirements for interpolation:

Tobler's first law must apply

If the data is not spatially autocorrelated our interpolation will be meaningless.

We know how to test for this using Moran's I from last week!

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Types of interpolation

- Thiessen polygons
- Inverse Distance Weighting (IDW)
- Spline

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Thiessen polygons

Simplest form of spatial interpolation

Also known as Voronoi diagram

Assumes values are constant in the neighbourhood around each sample

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Thiessen polygons

![https://upload.wikimedia.org/wikipedia/commons/d/d9/Voronoi_growth_euclidean.gif](../../img/Voronoi.gif) <!-- .element width="55%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Thiessen polygons

![Spatial interpolation, L MITAS AND H MITASOVA](../../img/voronoi_3d.png) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Thiessen polygons

Benefits:

- Popular for ordinal data: You can't have half a person
- Doesn't generate new values
- Easy to interpret

Limitations:

- Results in a blocky surface
- If we know data is continuous does it make sense?

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### IDW

Values that are closer to our interpolation point have more influence over the result

A distance-weighted mean

Either fixed distance or fixed number of points

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### IDW (Smooth)
<br><br>
## $$ Z_p = \frac{\sum_{i=1}^{n} \frac{Z_i}{d}}{\sum_{i=1}^{n} \frac{1}{d}}$$

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### IDW (Peak preserving)
<br><br>
## $$ Z_p = \frac{\sum_{i=1}^{n} \frac{Z_i}{d^2}}{\sum_{i=1}^{n} \frac{1}{d^2}}$$

</textarea>
</section>

<section>
  <h3>IDW</h3>
  <div data-svg-fragment-big="../../img/idw_example.svg#[*|label=a]">
      <a class="fragment" title="[*|label=b]"></a>
      <a class="fragment" title="[*|label=c]"></a>
      <a class="fragment" title="[*|label=d]"></a>
      <a class="fragment" title="[*|label=e]"></a>
      <a class="fragment" title="[*|label=f]"></a>
  </div>
</section>

<section data-markdown>
<textarea data-template>

### IDW

![Spatial interpolation, L MITAS AND H MITASOVA](../../img/idw_mitasova.png) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### IDW - barriers

![http://www.gisresources.com/barriers/](../../img/Barriers.jpg) <!-- .element width="55%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### IDW
Benefits:

- Easy to conceptualise
- Quick to process
- Preserves large scale features

Limitations:

- Bullseye pattern in some surfaces
- Very smooth result
- Will not pass through all points
- Small features will be lost

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Spline

- Fit a curve through the data points
- Trying to minimise the change in slope between points
- Weight parameter controls nature of the fit

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Spline

- Regularised splines:
  - Smoother surface
  - High weight leads to smooth surface, ignoring more points

- Tension splines:
  - Rougher surface
  - High weight creates 'stiffer' surface that passes through points more closely

</textarea>
</section>

<section>
  <h3>Spline</h3>
  <div data-svg-fragment-big="../../img/spline_example.svg#[*|label=a]">
      <a class="fragment" title="[*|label=b]"></a>
      <a class="fragment" title="[*|label=c]"></a>
      <a class="fragment" title="[*|label=d]"></a>
      <a class="fragment" title="[*|label=e]"></a>
      <a class="fragment" title="[*|label=f]"></a>
      <a class="fragment" title="[*|label=g]"></a>
      <a class="fragment" title="[*|label=h]"></a>
      <a class="fragment" title="[*|label=i]"></a>
  </div>
</section>

<section data-markdown>
<textarea data-template>

### Regularised spline

![Spatial interpolation, L MITAS AND H MITASOVA](../../img/spline_reg.png) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Tension spline

![Spatial interpolation, L MITAS AND H MITASOVA](../../img/spline_ten.png) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Spline

Benefits:

- Retain smaller features than IDW
- Creates a continuous surface
- Can be made to pass through all points

Limitations:

- Often over smooths surface
- Weight parameter hard to select
- Do we want to pass through all points?

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Limits of interpolation

- Can never perfectly predict values
- Cannot estimate values outside the bounds of our samples - this is **extrapolation**
- Easy to bias results based on type of interpolation used
- People like to see surfaces and may place too much weight on them
- Used without understanding thanks to simple GIS implementations

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Evaluating interpolation

In an ideal world we have the real data to compare to our interpolation

But then why are we doing the interpolation?

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Qualitative evaluation

- Does it look sane?

- What are our expectations of the data?

- Expert knowledge

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Quantitative evaluation

When we have a large dataset we can divide it into two sub-datasets:

- A training dataset
- A test dataset

Typically the majority of the data is put into the training dataset, and a
random sample of our measurements go into the test dataset.

The difference between a test point and our surface is a **residual** and we can
use residuals to understand the quality of our interpolation.

</textarea>
</section>

<section>
  <h3>Quantitative evaluation</h3>
  <div data-svg-fragment-big="../../img/evaluation_example.svg#[*|label=a]">
      <a class="fragment" title="[*|label=b]"></a>
      <a class="fragment" title="[*|label=c]"></a>
      <a class="fragment" title="[*|label=d]"></a>
      <a class="fragment" title="[*|label=e]"></a>
      <a class="fragment" title="[*|label=f]"></a>
      <a class="fragment" title="[*|label=g]"></a>
  </div>
</section>

<section data-markdown>
<textarea data-template>

### Quantitative evaluation

![Example of plotting residuals](../../img/residual_scatter.svg) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Quantitative evaluation

![Example of plotting a residual hist](../../img/residual_hist.svg) <!-- .element width="80%" -->

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Summary

- Difference between interpolation and extrapolation
- Interpolation is not magic!
- Applications and benefits of 3 different interpolation methods
- We can evaluate an interpolation both qualitatively and quantitatively

</textarea>
</section>

<section data-markdown>
<textarea data-template>

### Reading

- Mitas, Lubos, and Helena Mitasova. "Spatial interpolation." Geographical information systems: principles, techniques, management and applications 1, no. 2 (1999).
- PDF on QMplus

</textarea>
</section>

			</div>

		</div>

		<script src="../../reveal/lib/js/head.min.js"></script>
		<script src="../../reveal/js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,


        // Parallax background image
        parallaxBackgroundImage: "../../img/bg4.jpg", //https://unsplash.com/photos/OYFHT4X5isg

      	// Parallax background size
      	parallaxBackgroundSize: "4200px 1800px",

        // Number of slides away from the current that are visible
      	viewDistance: 3,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

        math: {
		           mathjax: '../../reveal/plugin/MathJax/MathJax.js',
		           config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
	            },

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '../../reveal/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../../reveal/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../../reveal/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../../reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../../reveal/plugin/search/search.js', async: true },
					{ src: '../../reveal/plugin/zoom-js/zoom.js', async: true },
					{ src: '../../reveal/plugin/notes/notes.js', async: true },
          { src: '../../reveal/plugin/math/math.js', async: true },
          { src: '../../reveal/plugin/embed-tweet.js' },
          { src: '../../reveal/plugin/reveal-svg-fragment.js', condition: function() { return !!document.querySelector( '[data-svg-fragment]' ); } },
          { src: '../../reveal/plugin/reveal-svg-fragment-big.js', condition: function() { return !!document.querySelector( '[data-svg-fragment-big]' ); } }
				]
			});

		</script>

	</body>
</html>
